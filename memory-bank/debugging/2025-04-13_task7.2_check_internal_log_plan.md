# Debugging Plan: Task 7.2 - Check Internal Worker Log

**Date:** 2025-04-13

**Objective:** Resume debugging Task 7.2 by running the E2E test and checking the internal worker debug log file (`worker_debug_log_{pid}.log`) generated by `ops_core/tasks/worker.py` to diagnose worker execution progress.

**Prerequisites:**
*   `live_dramatiq_worker` fixture in `ops-core/tests/conftest.py` uses `subprocess.Popen` with the `PYTHONPATH` fix. (Verified)
*   `ops_core/src/ops_core/tasks/worker.py` includes internal file logging to `worker_debug_log_{pid}.log`. (Verified)

**Plan Steps:**

1.  **Execute E2E Test:**
    *   Run the specific E2E test command in the terminal:
        ```bash
        tox exec -e py -- pytest ops-core/tests/integration/test_live_e2e.py::test_submit_task_and_poll_completion -m live -vvv -s
        ```
    *   **Expected Outcome:** The test is expected to fail with a timeout. The goal is to allow the worker subprocess time to run and generate its log.

2.  **Check for Worker Log File:**
    *   After the test command completes (likely after timeout), check for the existence of the worker's internal debug log file in the project root directory (`/home/sf2/Workspace/23-opspawn/1-t`).
    *   File Pattern: `worker_debug_log_*.log`
    *   Command (Example): `ls -l worker_debug_log_*.log`

3.  **Read Worker Log File (If Found):**
    *   If the log file exists, read its contents.
    *   Command (Example): `cat worker_debug_log_<pid>.log`

4.  **Analyze Log Contents & Report:**
    *   Analyze the log entries to determine how far the worker script (`ops_core/tasks/worker.py`) executed. Key points:
        *   Script start message?
        *   Logging setup completion?
        *   Broker import success?
        *   Engine import success?
        *   Actor discovery confirmation?
        *   End of initialization message?
        *   Any error messages?
    *   Report findings based on the log file's presence and content.

5.  **Propose Next Steps:**
    *   Based on the analysis, propose the next debugging steps.